<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!--
/*
 * INTER-Mediator Ver.@@@@2@@@@ Released @@@@1@@@@
 *
 *   by Masayuki Nii  msyk@msyk.net Copyright (c) 2011 Masayuki Nii, All rights reserved.
 *
 *   This project started at the end of 2009.
 *   INTER-Mediator is supplied under MIT License.
 */  -->

<html>
<head>
    <title>INTER-Mediator - Sample - Form Style/PostgreSQL</title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" type="text/css" href="../sample.css"/>
    <script type="text/javascript" src="include_PostgreSQL.php"></script>
    <script type="text/javascript">
        window.onload = function () {
            INTERMediator.navigationLabel = [null, null, null, null, null, null, null, null, false];
            INTERMediator.construct(true);
        };
        function doSearch() {
            INTERMediator.additionalCondition = {};
            INTERMediator.additionalCondition["postalcode"] = [];
            var c1 = IMLibLocalContext.getValue("placeCondition");
            if (c1 && c1.length > 0) {
                INTERMediator.additionalCondition["postalcode"].push({
                    field: 'f9', operator: 'LIKE', value: '%' + c1 + '%'
                });
            }
            var c2 = IMLibLocalContext.getValue("zipCondition");
            if (c2 && c2.length > 0) {
                INTERMediator.additionalCondition["postalcode"].push({
                    field: 'f3', operator: 'LIKE', value: c2 + '%'
                });
            }
            IMLibLocalContext.archive();    // This isn't required other than IE8.
            INTERMediator.startFrom = 0;
            INTERMediator.construct(true);
        }
        function doSortFieldChange(key, direction) {
            INTERMediator.additionalSortKey["postalcode"] = {field: key, direction: direction};
            doSearch(key, direction);
        }
    </script>
</head>
<body>
<div>
    地名(Place Name):
    <input type="text" data-im="_@placeCondition"/>
    検索は住所の「町域名」に一部分でも含まれる文字列を検索します。
</div>
<div>
    郵便番号(Zipcode):
    <input type="text" data-im="_@zipCondition"/>
    <button onclick="doSearch()">search</button>
    郵便番号を前方一致で検索します。
</div>
<div id="IM_NAVIGATOR">Navigation Controls by INTER-Mediator</div>
<table border="1" id="resultTable">
    <thead>
    <tr>
        <th>郵便番号
            <a href="javascript:doSortFieldChange('f3','ASC')">▼</a>
            <a href="javascript:doSortFieldChange('f3','DESC')">▲</a>
        </th>
        <th>都道府県</th>
        <th>市区町村</th>
        <th>町域名
            <a href="javascript:doSortFieldChange('f9','ASC')">▼</a>
            <a href="javascript:doSortFieldChange('f9','DESC')">▲</a>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <div data-im="postalcode@f3"></div>
        </td>
        <td>
            <div data-im="postalcode@f7"></div>
        </td>
        <td>
            <div data-im="postalcode@f8"></div>
        </td>
        <td>
            <div data-im="postalcode@f9"></div>
        </td>
    </tr>
    <tr data-im-control="noresult">
        <td colspan="4">検索結果はありません。あるいは検索前です。</td>
    </tr>
    </tbody>
</table>

</body>
</html>