<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!--
/*
 * INTER-Mediator Ver.@@@@2@@@@ Released @@@@1@@@@
 *
 *   by Masayuki Nii  msyk@msyk.net Copyright (c) 2011 Masayuki Nii, All rights reserved.
 *
 *   This project started at the end of 2009.
 *   INTER-Mediator is supplied under MIT License.
 */  -->

<html>
<head>
    <title>INTER-Mediator - Sample - Form Style/MySQL</title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="../sample.css" />
    <script type="text/javascript" src="include_FMS.php"></script>
    <script type="text/javascript">
        var searchCriteriaTown;
        var searchCriteriaZip;
        var whichSearch;
        function doSearchFromTown(key,direction)  {
            searchCriteriaTown = document.getElementById('place').value;
            searchCriteriaZip = document.getElementById('zipcode').value;
            whichSearch = 1;
            INTERMediator.additionalCondition["postalcode"] = {field:'f9',operator:'cn',value:searchCriteriaTown};
            INTERMediator.additionalSortKey["postalcode"] = {field:key,direction:direction};
            INTERMediator.startFrom = 0;
            INTERMediator.construct(true);
        }
        function doSearchFromZipcode(key,direction)  {
            searchCriteriaTown = document.getElementById('place').value;
            searchCriteriaZip = document.getElementById('zipcode').value;
            whichSearch = 2;
            INTERMediator.additionalCondition["postalcode"] = {field:'f3',operator:'bw',value:searchCriteriaZip};
            INTERMediator.additionalSortKey["postalcode"] = {field:key,direction:direction};
            INTERMediator.startFrom = 0;
            INTERMediator.construct(true);
        }
        INTERMediatorOnPage.expandingEnclosureFinish = function(name,target) {
            if ( name == 'postalcode' )   {
                document.getElementById('place').value = searchCriteriaTown;
                document.getElementById('zipcode').value = searchCriteriaZip;
            }
        }

    </script>
</head>
<body>
<div>
    地名(Place Name):
    <input type="text" id="place" value="落合" onkeydown="if(event.keyCode==13){doSearchFromTown('f3','ascend')}"/>
    <button onclick="doSearchFromTown('f3','ascend')">
        Search
    </button>
    検索は住所の「町域名」に一部分でも含まれる文字列を検索します。
</div>
<div>
    郵便番号(Zipcode):
    <input type="text" id="zipcode" value="123" onkeydown="if(event.keyCode==13){doSearchFromZipcode('f3','ascend')}" />
    <button onclick="doSearchFromZipcode('f3','ascend')">
        search
    </button>
    郵便番号を前方一致で検索します。
</div>
<div id="IM_NAVIGATOR">Navigation Controls by INTER-Mediator</div>
<table border="1" id="resultTable">
	<thead>
	<tr>
		<th>
            郵便番号
            <a href="javascript:whichSearch==2?doSearchFromZipcode('f3','ascend'):doSearchFromTown('f3','ascend')">▼</a>
            <a href="javascript:whichSearch==2?doSearchFromZipcode('f3','descend'):doSearchFromTown('f3','descend')">▲</a>
        </th>
		<th>都道府県</th>
		<th>市区町村</th>
		<th>町域名
            <a href="javascript:whichSearch==2?doSearchFromZipcode('f9','ascend'):doSearchFromTown('f9','ascend')">▼</a>
            <a href="javascript:whichSearch==2?doSearchFromZipcode('f9','descend'):doSearchFromTown('f9','descend')">▲</a>
        </th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td><div class="IM[postalcode@f3]"></div></td>
		<td><div class="IM[postalcode@f7]"></div></td>
		<td><div class="IM[postalcode@f8]"></div></td>
		<td><div class="IM[postalcode@f9]"></div></td>
	</tr>
	</tbody>
</table>

</body>
</html>